<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Basic Page Needs -->
    <title>Temporary Mail Queue Server</title>
    <meta charset="utf-8" />
    <meta name="description" content="Tech and D&amp;D, what more could you want?">
    <meta name="author" content="Ethan House">
    <!-- Mobile Specific Metas  -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="/theme/css/normalize.css">
    <link rel="stylesheet" type="text/css" href="/theme/css/skeleton.css">
    <link rel="stylesheet" type="text/css" href="/theme/css/ehouse.css">
    <link href="/theme/css/pygments.css" rel="stylesheet">
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/theme/images/favicon.png">
  </head>
  <body>
    <!-- Primary Page Layout -->
    <div class="container">
      <div class="row">
        <div class="column">
          <div id="nav">
            <ul>
                <li><a href="/">Blog</a></li>
                <li><a href="/projects.html">Projects</a></li>
                <li><a href="/dd.html">D&amp;D</a></li>
                <li><a href="/about.html">About</a></li>
            </ul>
          </div> <!-- #nav -->
          <div id="headerImage">
            <img alt="Train Bridge at Swarthmore College crossing Crum Creek" src="/theme/images/wide_bridge.jpg" />
          </div> <!-- #headerImage -->

<article>
  <h2><a href="../posts/temporary-mail-queue-server.html" rel="bookmark" title="Permalink to Temporary Mail Queue Server">Temporary Mail Queue Server</a></h2>
  <p class="date">Posted on June 21, 2015 by Ethan House </p>
  <p>I needed to stand up a temporary queue server to store mail while our primary
file server was out of commission. This was the config I created to do just
that. I went with OpenSMTPD because it was by far the easiest choice when
standing up a new SMTP server. I had the whole thing running in less then an
hour.</p>
<div class="highlight"><pre><span></span>pki csh certificate <span class="s2">&quot;/etc/ssl/certs/csh_star.crt&quot;</span>
pki csh key <span class="s2">&quot;/etc/ssl/private/csh_star.key&quot;</span>

listen on localhost
listen on egress port smtp tls pki csh

table aliases file:/etc/mail/aliases

bounce-warn 7d
expire 30d

accept from any <span class="k">for</span> domain <span class="s2">&quot;csh.rit.edu&quot;</span> <span class="nb">alias</span> &lt;aliases&gt; relay <span class="s2">&quot;mail.csh.rit.edu&quot;</span>
</pre></div>


<p>The server will hold the mail until it can be delivered. Users won't be able to
send but at least mail won't be lost. The final step is to setup the second
backup MX record for this mail host and turn everything on. Watch the mail queue
to make sure mail is being relayed.</p>
<p>Due to the lack of physical access and being students it's hard to prevent
issues like this. It's a bad solution to a worse problem but it solved our
looming problem of losing mail.</p>
</article>
<!--<a href="https://twitter.com/share" class="twitter-share-button"-->
   <!--data-count="horizontal" data-via="ewhouse">Tweet</a><script-->
   <!--type="text/javascript"-->
   <!--src="https://platform.twitter.com/widgets.js"></script>-->

<script>window.twttr = (function(d, s, id) {
     var js, fjs = d.getElementsByTagName(s)[0],
       t = window.twttr || {};
     if (d.getElementById(id)) return t;
     js = d.createElement(s);
     js.id = id;
     js.src = "https://platform.twitter.com/widgets.js";
     fjs.parentNode.insertBefore(js, fjs);
    
     t._e = [];
     t.ready = function(f) {
       t._e.push(f);
     };
    
     return t;
   }(document, "script", "twitter-wjs"));</script>

<a class="twitter-share-button"
     href="https://twitter.com/intent/tweet"> Tweet</a>

          <div class="footer">
            <ul>
                <li><a href="https://github.com/ehouse">Github</a></li>
                <li><a href="https://keybase.io/ehouse">Keybase</a></li>
                <li><a href="https://twitter.com/ewhhouse">Twitter</a></li>
            </ul>
            <p>Page generated by <a href="http://getpelican.com/">Pelican</a>. Theme Available on my <a href="https://github.com/ehouse/blog">Github</a>.</p>
            <p>&copy; Ethan House 2013 - 2016</p>
          </div> <!-- #footer -->
        </div> <!-- .column -->
      </div> <!-- .row -->
    </div> <!-- .container -->
  </body>
</html>